import type { PoolItem } from '../types';

// Category color map for UI rendering
export const CATEGORY_COLORS: Record<string, { bg: string; text: string; border: string }> = {
  'Product': { bg: '#dbeafe', text: '#1e40af', border: '#93c5fd' },
  'Technical': { bg: '#ffedd5', text: '#9a3412', border: '#fdba74' },
  'UX': { bg: '#ede9fe', text: '#5b21b6', border: '#c4b5fd' },
  'Design': { bg: '#fce7f3', text: '#9d174d', border: '#f9a8d4' },
  'SP': { bg: '#d1fae5', text: '#065f46', border: '#6ee7b7' },
};

// Category colors for timeline bars - Updated per spec
// Design: Purple/Violet, Product: Blue, Technical: Green, UX: Orange, SP: Teal/Cyan
export const CATEGORY_BAR_COLORS: Record<string, string> = {
  'Design': '#8b5cf6',              // Purple/Violet
  'Product': '#3b82f6',             // Blue
  'Technical': '#22c55e',           // Green
  'UX': '#f97316',                  // Orange
  'SP': '#06b6d4',                  // Teal/Cyan
};

// All available categories for filtering
export const ALL_CATEGORIES = [
  'Design',
  'Product',
  'Technical',
  'UX',
  'SP',
] as const;

export type CategoryType = typeof ALL_CATEGORIES[number];

// Priority sort order (High first)
const PRIORITY_ORDER: Record<string, number> = {
  'High': 0,
  'Medium': 1,
  'Low': 2,
  'TBD': 3,
  'TBC': 3,
  '': 4,
};

// Complexity to default sprint duration mapping
export const COMPLEXITY_TO_SPRINTS: Record<string, number> = {
  'High': 3,
  'Hight': 3, // handle typo in CSV
  'Medium': 2,
  'Low': 1,
  'TBD': 2,
  'TBC': 2,
  '': 2,
};

export function getDefaultSprintDuration(complexity: string): number {
  return COMPLEXITY_TO_SPRINTS[complexity.trim()] ?? 2;
}

export function getPriorityOrder(priority: string): number {
  return PRIORITY_ORDER[priority.trim()] ?? 4;
}

// Score sort order (highest first)
export function getScoreOrder(totalScore: number): number {
  return -totalScore; // Negative to sort descending
}

// All pool items from roadmap_v5_scored.csv where "To Pick up" = "Yes"
// Sorted by Total Score (descending), then by number
export const POOL_ITEMS: PoolItem[] = [
  {
    number: 35,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: 'Comprehensive audit of current design patterns and identify improvement areas.',
    ddaItem: false,
    featureName: 'Design Audit',
    summary: 'Comprehensive audit of current design patterns and identify improvement areas.',
    toBePickedUp: true,
    remarks: 'To be discussed with Ahmed',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 77,
    externalVisible: false,
    epicName: 'Design Audit',
    objectives: [
      'Review core screens and journeys and capture pain points with evidence (screenshots, examples).',
      'Identify quick wins vs larger redesign candidates and propose sequencing.',
      'Align priorities with Product and Engineering so the backlog is implementation-ready.',
    ],
    description: 'UI/UX designer reviews the current screens to identify room for improvement and the biggest pain points (usability, clarity, consistency). Output is a prioritized backlog with recommended fixes.',
    acceptanceCriteria: [
      'Audit report delivered with issues grouped by severity/impact and linked to screens.',
      'Prioritized improvement backlog created (with effort sizing placeholders).',
      'Top quick wins have clear specs and acceptance criteria ready for development.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Agreed scope of screens/flows to audit.',
      'Access to current designs/build, and top support ticket themes (if available).',
      'Review workshop with key stakeholders to finalize priorities.',
    ],
    targetAudience: ['UAE PASS users'],
  },
  {
    number: 40,
    category: 'Product',
    tag: 'New feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Enable Download of All Issued Documents in DV',
    summary: 'Enable downloading all issued documents in DV',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 88,
    externalVisible: false,
    epicName: 'Enable Download of All Issued Documents Types in DV',
    objectives: [
      'Allow users to download all issued documents available in DV.',
      'Reduce friction for users who need offline copies for personal record-keeping or external submissions.',
      'Ensure downloads respect issuer rules and user entitlements.',
    ],
    description: 'Enable downloading all issued documents in DV.',
    acceptanceCriteria: [
      'Enable the download of all the visualization based documents in Digital Vault.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      'Backend support for bulk selection and secure file packaging.',
      'Rate limiting and security controls to prevent abuse.',
    ],
    targetAudience: ['UAE PASS users', 'Support & Operations teams'],
  },
  {
    number: 10,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Auto-Add Documents Launch / One-Time Consent',
    summary: 'One-time consent for DV to periodically check and auto-add new/updated documents from issuers.',
    toBePickedUp: true,
    remarks: 'Pending Legal TDRA approval',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 86,
    externalVisible: false,
    epicName: 'Auto-Add Documents Launch / One-Time Consent',
    objectives: [
      'Introduce one-time consent allowing DV to periodically check for new/updated issued documents.',
      "Auto-add eligible documents to the user's vault with clear visibility and control.",
      'Reduce manual steps for users who frequently receive updated documents.',
    ],
    description: 'One-time consent for DV to periodically check and auto-add new/updated documents from issuers. Note: Pending Legal TDRA approval.',
    acceptanceCriteria: [
      'User can grant one-time consent and review what it enables (scope, frequency, revocation).',
      'System can detect and auto-add new/updated documents from participating issuers.',
      'User is notified (in-app and/or push) when a document is added/updated, with a link to view details.',
      'User can revoke consent and stop further checks; revocation takes effect within the stated window.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops', 'Legal/Compliance (approval gates)'],
    dependencies: [
      'Legal/TDRA approval for consent language and periodic checks (noted as a gate).',
      'Issuer availability and rules for which documents can be auto-added.',
      'Notification/UX design for new document events and opt-out controls.',
    ],
    targetAudience: ['UAE PASS users', 'Participating issuers / Service Providers', 'Legal & Compliance'],
  },
  {
    number: 19,
    category: 'SP',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: 'SP track',
    ddaItem: false,
    featureName: 'Form Filler',
    summary: 'Auto-fill forms using stored document data to streamline user workflows.',
    toBePickedUp: true,
    remarks: 'Service Provider related',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 82,
    externalVisible: false,
    epicName: 'Form Filler',
    objectives: [
      'Auto-fill Service Provider forms using existing document data to reduce manual typing.',
      'Support user review and edit before submission to avoid incorrect data.',
      'Improve completion rate for forms by reducing time and errors.',
    ],
    description: 'Auto-fill forms using stored document data to streamline user workflows. Note: Service Provider related.',
    acceptanceCriteria: [
      'Field mapping is versioned so form changes do not silently break auto-fill.',
      'Metrics tracked: time-to-complete and form submission success rate.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Mapping between DV document fields and Service Provider form fields.',
      'Consent and data-sharing rules for populating third-party forms.',
      'SDK or integration method for Service Providers to adopt the feature.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers (form owners)'],
  },
  {
    number: 52,
    category: 'SP',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'UAEVerify SEO',
    summary: 'Improve SEO of the UAEVerify website by adding proper metadata across key pages.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: 73,
    endSprint: 73,
    externalVisible: false,
    epicName: 'UAEVerify SEO',
    objectives: [
      'Implement SEO for the UAEVerify portal to improve search engine ranking.',
    ],
    description: 'Need to improve the SEO of the UAEVerify website by adding proper SEO metadata across key pages so the site can rank better in Google search results. This includes adding page-level meta tags and structured information that helps search engines index the site.',
    acceptanceCriteria: [
      'Improved rank for UAEVerify website in Google search, ideally appearing at the top.',
      'Meta data per page is as per approved copy.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Google algorithm takes time to improve the rank.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 53,
    category: 'SP',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Service Provider SDK',
    summary: 'Create a software development kit for Service Providers for Android and iOS app development.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'Service Provider SDK',
    objectives: [
      'Create a Software Development Kit (SDK) for Service Providers to improve implementation time.',
    ],
    description: 'Create a software development kit for Service Providers for Android and iOS app development. The SDK will have all the API implementations required for document sharing integration.',
    acceptanceCriteria: [
      'Easy-to-integrate setup for app development.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'iOS and Android development processes that SPs are following.',
    ],
    targetAudience: ['Service Providers'],
  },
  {
    number: 54,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'DR Automation',
    summary: 'Create scripts for automated disaster recovery drills including environment switching and DB failover.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'DR Automation',
    objectives: [
      'Prepare for the automated DR drill.',
    ],
    description: 'Create scripts for making apps live in one environment (DR) and stop in another (PROD), script to switch the primary DB, and script-based traffic switching.',
    acceptanceCriteria: [
      'Complete the DR under 20 minutes.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'FEDNET infrastructure availability.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 55,
    category: 'SP',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'SP Automation Testing Suite',
    summary: 'Create an automation testing suite for Service Providers to complement the SP SDK.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: 75,
    endSprint: 76,
    externalVisible: false,
    epicName: 'SP Automation Testing Suite',
    objectives: [
      'Create the automation testing suite for Service Providers.',
    ],
    description: 'Automation testing suite to complement SP SDK development. Testing activities will be automated after completion of development to accelerate SP integration validation.',
    acceptanceCriteria: [],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['Service Providers'],
  },
  {
    number: 56,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Blockchain Upgrade',
    summary: 'Upgrade the Digital Vault blockchain infrastructure to a more scalable and future-proof solution.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'Blockchain Upgrade',
    objectives: [
      'Upgrade the Digital Vault blockchain infrastructure.',
    ],
    description: 'The Blockchain Upgrade project aims to enhance the current blockchain infrastructure by selecting the most suitable blockchain technology, validating feasibility, and ensuring future scalability.',
    acceptanceCriteria: [
      'Fully functional DV app with new blockchain.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 57,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'CI/CD Pipeline Automation',
    summary: 'Automate deployment pipelines using a branching strategy for environment-specific deployments.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'CI/CD Pipeline Automation',
    objectives: [
      'Automate the deployment in respective environments using a branching strategy.',
    ],
    description: 'Implement a branching strategy so code is automatically deployed to the respective environment based on the branch (e.g., dev branch deploys to dev, staging branch deploys to staging, main to production).',
    acceptanceCriteria: [],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 58,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Operation Automation',
    summary: 'Automate operational tasks including incident report generation.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'Operation Automation',
    objectives: [
      'Automate operational tasks to reduce manual overhead.',
    ],
    description: 'Automate the incident report generation and other repetitive operational tasks to improve efficiency and reduce human error.',
    acceptanceCriteria: [],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 28,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Infinite Loaders Detection and Resolution',
    summary: 'Detect and resolve infinite loading states across the application.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: true,
    startSprint: 70,
    endSprint: 75,
    externalVisible: false,
    epicName: 'Infinite Loader Detection and Resolution',
    objectives: [
      'Detect and resolve infinite loading states across the application.',
    ],
    description: 'Fix infinite loading states across: Issuer list, Download and Share, QR verification, Notification list, actionable and non-actionable notification details, document selection screen, and include remaining scenarios.',
    acceptanceCriteria: [
      'Reduction of the loader occurrences across all identified scenarios.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 29,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Firebase Configuration & Optimization',
    summary: 'Firebase Remote Config and push notification optimization, monitoring, and maintenance.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'Firebase Configuration & Optimization',
    objectives: [
      'Create TTL-based document deletion.',
      'Timely deletion of anonymous users.',
    ],
    description: 'After the incident of 6th December, batch processes were stopped. These handled deletion of documents from the collection and deleting anonymous users. Now TTL-based document deletion and Google Function based scheduled deletion of anonymous users is needed.',
    acceptanceCriteria: [
      'The collection should have latest documents as per the configuration; all older documents should be deleted from Firebase.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Google cloud infrastructure availability.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 1,
    category: 'Product',
    tag: 'Reporting',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '2',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Status-Based Reporting Implementation',
    summary: 'Deploy 23-status-code tracking system to enable accurate measurement of all sharing requests. Foundation for all optimization. Database schema enhancement to track status transition history (previous_status, timestamps) for journey analysis.',
    toBePickedUp: true,
    remarks: 'To have a discussion to showcase the new model and the possible reports that can be achieved once its available',
    alreadyPickedUp: true,
    startSprint: 70,
    endSprint: 72,
    externalVisible: false,
    epicName: 'Status-Based Reporting Implementation',
    objectives: [
      'Introduce a consistent 23-status-code model for sharing requests so we can measure success/failure end-to-end.',
      'Store status transition history (previous status + timestamp) to enable journey analysis and operational reporting.',
      'Provide initial dashboards/reports that answer: volume, success rate, drop-off points, and top failure reasons.',
    ],
    description: 'Implement a consistent status model and status history for sharing requests to enable end-to-end reporting, diagnostics, and analytics.',
    acceptanceCriteria: [
      'Every sharing request is assigned exactly one current status from the agreed set.',
      'All status changes are persisted with timestamps and previous status.',
      'At least 3 core reports are available: overall success rate, drop-off by status, and top failure/error categories.',
      'Support team can map a user case to its latest status using a request identifier.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      'Agreement on the canonical status model and definitions (product + support).',
      'Database schema update to store status transitions and history.',
      'Instrumentation updates in backend services and clients to emit status transitions.',
      'Report consumer (dashboard / export) decision and access control.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers', 'Support & Operations teams', 'Product & Analytics stakeholders'],
  },
  {
    number: 17,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'Home Page Revamp',
    summary: 'Redesign the DV home page for improved user experience and engagement.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 76,
    externalVisible: false,
    epicName: 'Home Page Revamp',
    objectives: [
      'Redesign the DV home page to surface the most-used actions and recent items immediately.',
      'Reduce time-to-task for frequent journeys (share, request).',
      'Improve engagement by making status, alerts, and shortcuts visible and consistent.',
    ],
    description: 'Redesign the DV home page to prioritize top tasks and reduce navigation friction.',
    acceptanceCriteria: [
      'Home page highlights 3-5 primary actions and recent/important items without scrolling on common devices.',
      'Users can reach top tasks within 1-2 taps from home.',
      'Analytics events added for key home interactions (cards, shortcuts).',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Agreement on the primary jobs-to-be-done for the home screen.',
      'Analytics baseline for current home usage and drop-offs.',
      'Design system update alignment (components, spacing, typography).',
    ],
    targetAudience: ['UAE PASS users'],
  },
  {
    number: 16,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'Design System Update',
    summary: 'Update and maintain the DV design system for consistency across platforms.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 78,
    externalVisible: false,
    epicName: 'Design System Update (DDA Dependent)',
    objectives: [
      'Update and enhance the DV design system components and patterns based on current product needs.',
      'Align DV and DDA design standards where applicable to reduce divergence.',
      'Improve implementation consistency by publishing clear guidelines and reusable assets.',
    ],
    description: 'Joint effort with the DDA UI/UX team to update and enhance the DV design system so it stays up to date and supports consistent implementation across teams.',
    acceptanceCriteria: [
      'Updated design system published with versioning and change log.',
      'High-usage components are standardized and adopted in the app.',
      'New work uses updated components; legacy screens have a migration plan.',
    ],
    owners: ['Product Design (UX/UI)', 'DDA UX/UI Team (joint)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Regular working sessions with DDA UI/UX team and agreement on standards.',
      'Component inventory and gap analysis (what exists vs what is missing).',
      'Engineering adoption plan for component library updates and migration.',
    ],
    targetAudience: ['UAE PASS users'],
  },
  {
    number: 5,
    category: 'Product',
    tag: 'Reporting',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '1',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'User Behavior Analytics Tool Selection',
    summary: 'Select and integrate analytics tool (UXCam/Firebase Analytics) to enable data-driven optimization, session replay, and Real User Monitoring (RUM) for user behavior patterns.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 84,
    externalVisible: false,
    epicName: 'User Behavior Analytics Tool Selection (DDA Dependent)',
    objectives: [
      'Select a user-behavior analytics tool that supports session replay and key funnels for DV journeys.',
      'Instrument core flows to measure drop-offs and time-to-complete (home to select doc to share/request).',
      'Enable Real User Monitoring (RUM) signals to correlate performance issues with user impact.',
    ],
    description: 'Select and integrate analytics tool (UXCam/Firebase Analytics) to enable data-driven optimization, session replay, and Real User Monitoring (RUM) for user behavior patterns.',
    acceptanceCriteria: [
      'Tool decision documented with reasons (capabilities, cost, privacy/security, integration effort).',
      'Event taxonomy defined for at least 10 key events + 3 funnels.',
      'Dashboards show funnel conversion + top screens with rage taps/crashes/performance issues.',
      'Session replay is enabled for approved users with PII masking rules.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      'Security, privacy, and data retention review for candidate tools (e.g., Firebase Analytics vs UXCam).',
      'Mobile app instrumentation plan and event taxonomy aligned to the status model.',
      'Access model for who can view session replays (PII considerations).',
    ],
    targetAudience: [],
  },
  {
    number: 7,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'UX Enhancements Bundle - Revisit Documents List View',
    summary: 'Placeholder for UI/UX enhancements.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 76,
    externalVisible: false,
    epicName: 'UX Enhancements Bundle - 1',
    objectives: [
      'Improve the documents list view so users can find, filter, and act on documents faster.',
      'Reduce cognitive load by clarifying document status, issuer, and last update at a glance.',
      'Support common actions directly from the list (view, share, download) with fewer taps.',
    ],
    description: 'This is a place holder item to implement the outcomes of design audit and Design system epics.',
    acceptanceCriteria: [
      'TBD - defined after design audit outputs are available.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Analytics/funnel data to prioritize list pain points (filter usage, search behavior).',
      'Design system components availability and alignment.',
      'Backend APIs support for filtering/sorting (if not already available).',
    ],
    targetAudience: ['UAE PASS users'],
  },
  {
    number: 8,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Error-to-Status Code Linking System',
    summary: 'Structured error taxonomy mapped to status codes for automated troubleshooting and support ticket reduction.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 76,
    externalVisible: false,
    epicName: 'Error to Status Code Linking',
    objectives: [
      'Create the operational dashboard to track the state of the sharing request using the latest status model.',
    ],
    description: 'Structured error taxonomy mapped to status codes for automated troubleshooting and operational dashboard for sharing request tracking.',
    acceptanceCriteria: [
      'Should be able to track the sharing request using ID.',
      'Track the respective state for the sharing request.',
      'Updated funnel chart.',
    ],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'The data should be present in production as agreed format; there might be some updates required to optimize the visualization at DB side.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 9,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Dual Citizenship GA',
    summary: 'Complete Primary/Secondary EID handling with final EN/AR copy approval and edge case handling.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: true,
    startSprint: 72,
    endSprint: 72,
    externalVisible: false,
    epicName: 'Dual Citizenship',
    objectives: [
      'Finalize Primary/Secondary EID handling across all relevant flows.',
      'Complete EN/AR copy approval and validate edge cases to reduce user confusion and support load.',
      'Ensure downstream integrations behave correctly for both primary and secondary identifiers.',
    ],
    description: 'Complete Primary/Secondary EID handling with final EN/AR copy approval and edge case handling.',
    acceptanceCriteria: [
      'User can add/manage primary and secondary EID where applicable without breaking existing accounts.',
      'All impacted screens have approved EN/AR copy.',
      'Edge cases covered: switching primary, duplicate detection, and issuer retrieval using the correct identifier.',
      'No increase in authentication failure rate after release (tracked for first 2 weeks).',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      'ICP/DDA Dual citizenship flag availability.',
      'Backend validation rules for primary/secondary EID storage and retrieval.',
      'Regression coverage for authentication, profile, and document flows.',
    ],
    targetAudience: ['UAE PASS users', 'Support & Operations teams'],
  },
  {
    number: 18,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'UX/UI Enhancements Bundle 2',
    summary: 'Second bundle of UI/UX improvements based on user feedback and analytics.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 94,
    externalVisible: false,
    epicName: 'UX/UI Enhancements Bundle 2',
    objectives: [
      'Deliver the second bundle of UI/UX improvements based on feedback and observed behavior.',
      'Address the top 3 usability issues discovered after analytics tooling is in place.',
    ],
    description: 'Second bundle of UI/UX improvements based on design audit, design system update and accessibility findings.',
    acceptanceCriteria: [
      'TBD - to be defined based on design audit and analytics outputs.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Design Audit outputs.',
      'Design System Update completion.',
      'Accessibility Enhancement reports.',
    ],
    targetAudience: ['UAE PASS users'],
  },
  {
    number: 37,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Enhancement/Revamp Document Request',
    summary: 'Redesign the document request flow for improved user experience.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 80,
    externalVisible: false,
    epicName: 'Document Request Revision',
    objectives: [
      'Redesign the document request flow so users understand what is being requested and why.',
      'Reduce request abandonment by simplifying steps and clarifying expected outcomes.',
      'Improve request success rate and reduce support escalations.',
    ],
    description: 'Redesign the document request journey with clearer steps, better copy, and trackable outcomes aligned to the status model.',
    acceptanceCriteria: [
      'Request flow has clear steps: select provider/context to confirm scope to send to track outcome.',
      'User can track request status using the status model (e.g., sent, viewed, completed, failed).',
      'Error states include actionable recovery steps (retry, contact support, change provider).',
      'A/B or usability review indicates improved comprehension vs current flow.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Service Provider requirements for request payload and response handling.',
      'Copywriting in EN/AR for key request states and error handling.',
      'Status model alignment so request states map cleanly to reporting.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 38,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Revamp Document Sharing',
    summary: 'Redesign document sharing flow to increase success',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 86,
    externalVisible: false,
    epicName: 'Document Sharing Revision',
    objectives: [
      'Redesign the sharing flow to increase successful shares and reduce retries.',
      'Make selection, consent, and confirmation steps obvious and lightweight.',
      'Improve failure recovery: clear reasons, next steps, and support hooks.',
    ],
    description: 'Revamp the sharing flow across selection, consent, confirmation, and failure recovery, tied to status-based reporting for measurable improvements.',
    acceptanceCriteria: [
      'Share flow supports: select document(s) to select recipient/provider to confirm scope/consent to share to track result.',
      'Failures show the mapped status/error category and a recommended action (retry, switch channel, contact support).',
      'Share success rate baseline established and post-release tracked.',
      'Support can diagnose a failed share using request ID and status history.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Status-based reporting to identify top failure states and where users drop off.',
      'Design system components for consistent share UI patterns.',
      'Backend support for retry-safe operations and better error messages.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers', 'Support teams'],
  },
  {
    number: 47,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'ELK Stack AI Upgrade',
    summary: 'Upgrade Elasticsearch Logstash Kibana stack to leverage AI capabilities for enhanced log analysis and anomaly detection.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'ELK Stack AI Upgrade',
    objectives: [
      'Upgrade the ELK Stack to leverage AI/ML capabilities for enhanced log analysis.',
      'Implement anomaly detection to proactively identify system issues.',
    ],
    description: 'Upgrade Elasticsearch, Logstash, and Kibana stack to leverage AI capabilities for enhanced log analysis, anomaly detection, and improved observability.',
    acceptanceCriteria: [],
    owners: ['Product Management', 'Backend Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['Support & Operations teams', 'Product & Analytics stakeholders'],
  },
  {
    number: 26,
    category: 'Technical',
    tag: '',
    priority: 'Medium',
    priorityScore: 5,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'License QR Code Display Fix',
    summary: 'Fix License Name and Number not showing when customer scans QR code from UAE Verify portal.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'UAE Verify QR Code Scan vs Document Upload',
    objectives: [
      'Fix License Name and Number not showing when customer scans QR code from UAE Verify portal.',
    ],
    description: 'Fix License Name and Number not showing when customer scans QR code from UAE Verify portal.',
    acceptanceCriteria: [],
    owners: ['Service Provider Enablement/Partnerships', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 20,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Consent Sharing (Third Party Data)',
    summary: 'Sharing third party data via providing consent mechanism.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 85,
    externalVisible: false,
    epicName: 'Consent Sharing (Third Party Data)',
    objectives: [
      'Enable sharing of third-party data through an explicit, user-controlled consent mechanism.',
      'Standardize consent capture (who, what, why, duration) to support audits and user trust.',
      'Support downstream APIs to verify consent before data is shared.',
    ],
    description: 'Sharing third party data via providing consent mechanism.',
    acceptanceCriteria: [
      'Before any third-party data is shared, the user is shown scope + purpose and must confirm.',
      'Consents are stored with timestamp, requester identity, scope, and expiry (if applicable).',
      'User can view and revoke active consents.',
      'APIs enforce consent checks and log consent reference IDs for audit.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops', 'Legal/Compliance (approval gates)'],
    dependencies: [
      'Consent model definition (data fields, TTL/expiry, revocation) and storage.',
      'UX patterns for clear disclosure and granular selection where needed.',
      'Legal/compliance review for consent wording and audit requirements.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers requesting third-party data', 'Legal & Compliance', 'Audit/Operations'],
  },
  {
    number: 32,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Automated Testing',
    summary: 'Implement automated testing framework for regression and quality assurance, including UI test automation and tool fitment analysis.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: null,
    externalVisible: false,
    epicName: 'Automated Testing',
    objectives: [
      'Implement automated testing framework for regression and quality assurance.',
      'Include UI test automation and tool fitment analysis.',
    ],
    description: 'Implement automated testing framework for regression and quality assurance, including UI test automation and tool fitment analysis.',
    acceptanceCriteria: [],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [],
    targetAudience: ['Development & QA teams'],
  },
  {
    number: 36,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: true,
    featureName: 'Accessibility Enhancement',
    summary: 'Improve accessibility compliance (WCAG) across the application.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 82,
    externalVisible: false,
    epicName: 'Accessibility Enhancement (DDA Dependent)',
    objectives: [
      'Improve accessibility compliance across priority screens and critical flows.',
      'Embed accessibility checks into design, development, and QA so issues do not regress.',
      'Reduce accessibility-related user friction and support cases.',
    ],
    description: 'Increase the level of accessibility support in the app across key DV screens and flows (screen reader, contrast, dynamic text, focus order, touch targets) and validate against an agreed WCAG target.',
    acceptanceCriteria: [
      'Priority flows meet the agreed accessibility checklist (labels, focus, scaling, contrast).',
      'Accessibility checklist is added to QA and release criteria.',
      'Remaining gaps are documented with owners and a mitigation plan.',
    ],
    owners: ['Product Design (UX/UI)', 'Product Management', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Define target WCAG level and priority flows in scope.',
      'Accessibility guidelines for designers and developers (components + content).',
      'Testing approach (manual + automated) for iOS/Android.',
    ],
    targetAudience: [],
  },
  {
    number: 41,
    category: 'Product',
    tag: 'New feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Physical Document Sharing',
    summary: 'Enable sharing of physical document representations or verified copies.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    endSprint: 94,
    externalVisible: false,
    epicName: 'Over the Counter Document Sharing',
    objectives: [
      'Enable sharing of documents over the counter through UAE PASS.',
    ],
    description: 'Enable sharing of Digital Vault documents over the counter.',
    acceptanceCriteria: [
      'TBD - to be defined based on stakeholder requirements.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      "Definition of 'verified copy' workflow and acceptable document types.",
      'Service Provider acceptance format and validation requirements.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
  {
    number: 50,
    category: 'SP',
    tag: '',
    priority: 'Medium',
    priorityScore: 5,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 10,
    track: '',
    ddaItem: false,
    featureName: 'SP Offboarding',
    summary: 'Create a process for offboarding already-onboarded Service Providers, with the option of re-onboarding.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: 73,
    endSprint: 76,
    externalVisible: false,
    epicName: 'SP Offboarding',
    objectives: [
      'Provide a controlled way to offboard Service Providers without breaking active user journeys.',
      'Remove stale integrations and reduce operational burden.',
    ],
    description: 'Create a process for offboarding already-onboarded Service Providers, with the option of re-onboarding.',
    acceptanceCriteria: [
      'Provider can be disabled via configuration without a new app release (where possible).',
      'Offboarding is logged and auditable (who/when/why).',
      'No critical errors caused by disabled providers in production.',
    ],
    owners: ['Service Provider Onboarding team', 'Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance'],
    dependencies: [
      'Inventory of active Service Providers and their integration method.',
      'Backend flags/config to disable providers safely (with rollback).',
      'Support playbook and communications plan for affected providers/users.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers', 'Support & Operations teams'],
  },
  {
    number: 51,
    category: 'SP',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'QR Code Simplification – Direct Sharing',
    summary: 'Simplify the QR code generation logic and introduce a new way to trigger sharing requests from the SP channel.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: 73,
    endSprint: 77,
    externalVisible: false,
    epicName: 'QR Code Simplification – Direct Sharing',
    objectives: [
      'Address SP feedback on the difficulty of scanning the current QR codes.',
      'Simplify the UX/UI for sharing.',
      'Make it easier for SPs to integrate the document sharing functionality.',
    ],
    description: 'Simplify the QR code generation logic and introduce a new way to trigger the sharing requests to the user from the SP channel.',
    acceptanceCriteria: [
      'TBD - to be defined based on SP feedback and design proposals.',
    ],
    owners: ['Product Management', 'Backend Development', 'Frontend/Mobile Development', 'Quality Assurance', 'Customer Support / Ops'],
    dependencies: [
      'DDA exposure of UDID identification services from email or mobile number or EID.',
      'Existing integrations with Service Providers.',
    ],
    targetAudience: ['UAE PASS users', 'Service Providers'],
  },
].sort((a, b) => {
  // Sort by total score first (descending)
  if (a.totalScore !== b.totalScore) return b.totalScore - a.totalScore;
  // Then by priority order
  const pa = getPriorityOrder(a.priority);
  const pb = getPriorityOrder(b.priority);
  if (pa !== pb) return pa - pb;
  // Then by number
  return a.number - b.number;
});
