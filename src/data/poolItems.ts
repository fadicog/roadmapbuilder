import type { PoolItem } from '../types';

// Category color map for UI rendering
export const CATEGORY_COLORS: Record<string, { bg: string; text: string; border: string }> = {
  'Product': { bg: '#dbeafe', text: '#1e40af', border: '#93c5fd' },
  'Technical': { bg: '#ffedd5', text: '#9a3412', border: '#fdba74' },
  'UX': { bg: '#ede9fe', text: '#5b21b6', border: '#c4b5fd' },
  'Design': { bg: '#fce7f3', text: '#9d174d', border: '#f9a8d4' },
  'SP': { bg: '#d1fae5', text: '#065f46', border: '#6ee7b7' },
};

// Category colors for timeline bars - Updated per spec
// Design: Purple/Violet, Product: Blue, Technical: Green, UX: Orange, SP: Teal/Cyan
export const CATEGORY_BAR_COLORS: Record<string, string> = {
  'Design': '#8b5cf6',              // Purple/Violet
  'Product': '#3b82f6',             // Blue
  'Technical': '#22c55e',           // Green
  'UX': '#f97316',                  // Orange
  'SP': '#06b6d4',                  // Teal/Cyan
};

// All available categories for filtering
export const ALL_CATEGORIES = [
  'Design',
  'Product',
  'Technical',
  'UX',
  'SP',
] as const;

export type CategoryType = typeof ALL_CATEGORIES[number];

// Priority sort order (High first)
const PRIORITY_ORDER: Record<string, number> = {
  'High': 0,
  'Medium': 1,
  'Low': 2,
  'TBD': 3,
  'TBC': 3,
  '': 4,
};

// Complexity to default sprint duration mapping
export const COMPLEXITY_TO_SPRINTS: Record<string, number> = {
  'High': 3,
  'Hight': 3, // handle typo in CSV
  'Medium': 2,
  'Low': 1,
  'TBD': 2,
  'TBC': 2,
  '': 2,
};

export function getDefaultSprintDuration(complexity: string): number {
  return COMPLEXITY_TO_SPRINTS[complexity.trim()] ?? 2;
}

export function getPriorityOrder(priority: string): number {
  return PRIORITY_ORDER[priority.trim()] ?? 4;
}

// Score sort order (highest first)
export function getScoreOrder(totalScore: number): number {
  return -totalScore; // Negative to sort descending
}

// All pool items from roadmap_v5_scored.csv where "To Pick up" = "Yes"
// Sorted by Total Score (descending), then by number
export const POOL_ITEMS: PoolItem[] = [
  {
    number: 35,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: 'Comprehensive audit of current design patterns and identify improvement areas.',
    ddaItem: false,
    featureName: 'Design Audit',
    summary: 'Comprehensive audit of current design patterns and identify improvement areas.',
    toBePickedUp: true,
    remarks: 'To be discussed with Ahmed',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 40,
    category: 'Product',
    tag: 'New feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Enable Download of All Issued Documents in DV',
    summary: 'Enable downloading all issued documents in DV',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 10,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Auto-Add Documents Launch / One-Time Consent',
    summary: 'One-time consent for DV to periodically check and auto-add new/updated documents from issuers.',
    toBePickedUp: true,
    remarks: 'Pending Legal TDRA approval',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 19,
    category: 'SP',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: 'SP track',
    ddaItem: false,
    featureName: 'Form Filler',
    summary: 'Auto-fill forms using stored document data to streamline user workflows.',
    toBePickedUp: true,
    remarks: 'Service Provider related',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 28,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Infinite Loaders Detection and Resolution',
    summary: 'Detect and resolve infinite loading states across the application.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: true,
    startSprint: 70,
    externalVisible: false,
  },
  {
    number: 29,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 16,
    track: '',
    ddaItem: false,
    featureName: 'Firebase Configuration & Optimization',
    summary: 'Firebase Remote Config and push notification optimization, monitoring, and maintenance.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 1,
    category: 'Product',
    tag: 'Reporting',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '2',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Status-Based Reporting Implementation',
    summary: 'Deploy 23-status-code tracking system to enable accurate measurement of all sharing requests. Foundation for all optimization. Database schema enhancement to track status transition history (previous_status, timestamps) for journey analysis.',
    toBePickedUp: true,
    remarks: 'To have a discussion to showcase the new model and the possible reports that can be achieved once its available',
    alreadyPickedUp: true,
    startSprint: 70,
    externalVisible: false,
  },
  {
    number: 17,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'Home Page Revamp',
    summary: 'Redesign the DV home page for improved user experience and engagement.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 16,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'Design System Update',
    summary: 'Update and maintain the DV design system for consistency across platforms.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 5,
    category: 'Product',
    tag: 'Reporting',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '1',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: true,
    featureName: 'User Behavior Analytics Tool Selection',
    summary: 'Select and integrate analytics tool (UXCam/Firebase Analytics) to enable data-driven optimization, session replay, and Real User Monitoring (RUM) for user behavior patterns.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 7,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'UX Enhancements Bundle - Revisit Documents List View',
    summary: 'Placeholder for UI/UX enhancements.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 8,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Error-to-Status Code Linking System',
    summary: 'Structured error taxonomy mapped to status codes for automated troubleshooting and support ticket reduction.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 9,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Dual Citizenship GA',
    summary: 'Complete Primary/Secondary EID handling with final EN/AR copy approval and edge case handling.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: true,
    startSprint: 72,
    externalVisible: false,
  },
  {
    number: 18,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'UX/UI Enhancements Bundle 2',
    summary: 'Second bundle of UI/UX improvements based on user feedback and analytics.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 37,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Enhancement/Revamp Document Request',
    summary: 'Redesign the document request flow for improved user experience.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 38,
    category: 'UX',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'Revamp Document Sharing',
    summary: 'Redesign document sharing flow to increase success',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 47,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'Medium',
    complexityScore: 5,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'ELK Stack AI Upgrade',
    summary: 'Upgrade Elasticsearch Logstash Kibana stack to leverage AI capabilities for enhanced log analysis and anomaly detection.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 26,
    category: 'Technical',
    tag: '',
    priority: 'Medium',
    priorityScore: 5,
    relatesTo: '',
    complexity: 'Low',
    complexityScore: 8,
    totalScore: 13,
    track: '',
    ddaItem: false,
    featureName: 'License QR Code Display Fix',
    summary: 'Fix License Name and Number not showing when customer scans QR code from UAE Verify portal.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 20,
    category: 'Product',
    tag: 'New Feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Consent Sharing (Third Party Data)',
    summary: 'Sharing third party data via providing consent mechanism.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 32,
    category: 'Technical',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Automated Testing',
    summary: 'Implement automated testing framework for regression and quality assurance, including UI test automation and tool fitment analysis.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 36,
    category: 'Design',
    tag: '',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: true,
    featureName: 'Accessibility Enhancement',
    summary: 'Improve accessibility compliance (WCAG) across the application.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
  {
    number: 41,
    category: 'Product',
    tag: 'New feature',
    priority: 'High',
    priorityScore: 8,
    relatesTo: '',
    complexity: 'High',
    complexityScore: 3,
    totalScore: 11,
    track: '',
    ddaItem: false,
    featureName: 'Physical Document Sharing',
    summary: 'Enable sharing of physical document representations or verified copies.',
    toBePickedUp: true,
    remarks: '',
    alreadyPickedUp: false,
    startSprint: null,
    externalVisible: false,
  },
].sort((a, b) => {
  // Sort by total score first (descending)
  if (a.totalScore !== b.totalScore) return b.totalScore - a.totalScore;
  // Then by priority order
  const pa = getPriorityOrder(a.priority);
  const pb = getPriorityOrder(b.priority);
  if (pa !== pb) return pa - pb;
  // Then by number
  return a.number - b.number;
});
